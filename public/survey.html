<!DOCTYPE html>
<html>

<head>
    <title>Friend Finder Survey</title>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <script src="https://code.jquery.com/jquery.js"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

</head>

<body>
    <div class="container">
        <div class="jumbotron">
            <h1>
                <center><strong>Friend Finder</strong></center>
            </h1>
            <h2>
                <center><strong>Personality Compatibility Survey</strong></center>
            </h2>
            <h4>
                <center>For each of the statements below..Please Specify Option 1 to 5. 1 for Strongly Disagree to 5 for Strongly Agree</center>
            </h4>
        </div>

        <div>
            <form role="form">
                <div class="form-group">
                    <label for="name" class="col-sm-2 control-label">Name</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="name" placeholder="Name" required="true">
                    </div>
                </div>
                <br>
                <br>
                <div class="form-group">
                    <label for="imageURL" class="col-sm-2 control-label">Your Image URL</label>
                    <div class="col-sm-10">
                        <input type="url" class="form-control" id="imageURL" placeholder="Your Image URL" required="true">
                    </div>
                </div>
                <br><br>

                <h4>Do you love Music?</h4>
                <select required="true" class="form-control" id="sel1" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>Do you like to travel?</h4>
                <select required="true" class="form-control" id="sel2" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>Do you like animals?</h4>
                <select required="true" class="form-control" id="sel3" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>Do you like sports?</h4>
                <select required="true" class="form-control" id="sel4" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>Politically are you conservative?</h4>
                <select required="true" class="form-control" id="sel5" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>Are you a spiritual person?</h4>
                <select required="true" class="form-control" id="sel6" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>Do you look to others for advice on life?</h4>
                <select required="true" class="form-control" id="sel7" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>Have you done much volunteer work for projects you believe in?</h4>
                <select required="true" class="form-control" id="sel8" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>Are you an outgoing person?</h4>
                <select required="true" class="form-control" id="sel9" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <h4>How important are others needs in comparison to your own needs</h4>
                <select required="true" class="form-control" id="sel10" title=""="Select your response">
					<option value="">select an option</option>
					<option value="1">1 (Strongly Disagree)</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="5">5 (Strongly Agree)</option>
				</select>
                <br>

                <button type="submit" class="btn btn-info btn-primary btn-lg btn-block submit" data-toggle="modal" data-target="#myModal">Submit Survey - Find your Friend</button>
                <br><br><br>
            </form>
        </div>

        <!-- Modal -->
        <div id="myModal" class="modal fade" role="dialog">
            <div class="modal-dialog">
                <!-- Modal content-->
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">
                            <center>Closest Matched Friend Per Your Choices</center>
                        </h4>
                    </div>
                    <div class="modal-body">
                        <h6>Your Choices Most Closely Match with:</h6>
                        <h4 id="friend-name" display="inline"></h4>
                        <img src="" alt="" id="friend-image">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script type="text/javascript">
        $(".submit").on("click", function(event) {
            event.preventDefault();

            var allInputProvided = true;
            var selectedOption = "";

            var enteredName = $("#name").val().trim();
            var enteredURL = $("#imageURL").val().trim();

            //Validate if all info required is entered
            if (enteredName === "" || enteredURL === "") {
                allInputProvided = false;
                window.alert("You must enter Name and the Image URL");
                console.log("You must enter Name and the Image URL");
            }

            if (allInputProvided) {
                var selections = [];
                for (var i = 0; i < 10; i++) {
                    var idOfQuestion = "#sel" + (i + 1);
                    selectedOption = $(idOfQuestion).val().trim();
                    if (selectedOption === "") {
                        allInputProvided = false;
                        window.alert("You must specify a option of 1 to 5 for all the questions");
                        console.log("You must specify a option of 1 to 5 for all the questions");
                        break;
                    }
                    selections.push(selectedOption);
                }
            }

            if (allInputProvided) {
                // var newSurvey = {
                // 	name: $("#name").val().trim(),
                // 	imageURL: $("#imageURL").val().trim(),
                // 	answers: selections
                // };

                var newSurvey = {
                    name: enteredName,
                    imageURL: enteredURL,
                    answers: selections
                };

                $.post("/api/submitSurvey", newSurvey, function(data) {
                    if (data) {
                        $("#friend-name").text(data.name);
                        $("#friend-image").attr("src", data.imageURL);
                        $("#friend-image").attr("alt", "The Image URL " + data.imageURL + " provided by " + data.name + " is not allowing hot linking and the image cannot be displayed here. Please open that URL from the browser directly");
                    }
                });

                //Now we can clear it for the next friend submission.
                $("#name").val("");
                $("#imageURL").val("");
                for (var i = 0; i < 10; i++) {
                    idOfQuestion = "#sel" + (i + 1);
                    $(idOfQuestion).val("");
                }
            } else {
                $("#friend-name").text("You Didn't Enter Your Profile. No Friend Can be Suggested");
                $("#friend-image").attr("src", "");
                $("#friend-image").attr("alt", "");
                window.alert("Sorry ..No Friend Found ..You didnt provide your profile");
            }
        });
    </script>
</body>

</html>